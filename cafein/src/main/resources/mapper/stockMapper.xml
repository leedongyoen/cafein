<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="StockDAO"> 


	<resultMap type="stock" id="stockMap">
	     <id column="ST_NUM" property="stNum"></id>
	     <result column="S_ID" property="sId" />
	     <result column="ST_NAME" property="stName" />
	     <result column="ST_QTY" property="stQty" />
	     <result column="ST_AQTY" property="stAqty" />
	     <result column="ST_PRICE" property="stPrice" />
	     <result column="CA_NUM" property="caNum" />
	     <result column="STAN_UNIT" property="stanUnit" />
	     <result column="ST_STATUS" property="stStatus" />
	     <result column="TRUTH_QTY" property="truthQty" />
	</resultMap>
   
   
  <select id="getStockList" resultMap="stockMap">
  	SELECT 
		st_num,
		s_id,
		st_name,
		st_qty,
		st_aqty,
		st_price,
		ca_num,
		stan_unit,
		st_status,
		truth_qty
	FROM STOCK
  </select>
  
   <select id="getStock" resultMap="stockMap">
  	SELECT 
		st_num,
		s_id,
		st_name,
		st_qty,
		st_aqty,
		st_price,
		ca_num,
		stan_unit,
		st_status,
		truth_qty
	FROM STOCK
	WHERE st_num = #{stNum}
  
  </select>
  
  <insert id="insertStock" parameterType="stock">
  
  	INSERT INTO STOCK (st_num,
					s_id,
					st_name,
					st_qty,
					st_aqty,
					st_price,
					ca_num,
					stan_unit,
					st_status,
					truth_qty
					)
					
				VALUES (
					'ST'||LPAD(stock_seq.nextval,3,0),
					#{sId},
					#{stName},
					#{stQty},
					#{stAqty},
					#{stPrice},
					#{caNum},
					#{stanUnit},
					#{stStatus},
					#{truthQty}
				)
  	</insert>
   
   <update id="updateStock" parameterType="stock">
      UPDATE stock
      <set>
         <if test="sId != null and sId != ''">s_id = #{sId},</if>
         <if test="stName != null and stName != ''">st_name = #{stName},</if>
         <if test="stQty != null and stQty != ''">st_qty = #{stQty},</if>
         <if test="stAqty != null and stAqty != ''">st_aqty = #{stAqty},</if>
         <if test="stPrice != null and stPrice != ''">st_price = #{stPrice},</if>
         <if test="caNum != null and caNum != ''">ca_num = #{caNum},</if>
         <if test="stanUnit != null and stanUnit != ''">stan_unit = #{stanUnit},</if>
         <if test="stStatus != null and stStatus != ''">st_status = #{stStatus},</if>
         <if test="truthQty != null and truthQty != ''">truth_qty = #{truthQty},</if>
            </set>
      WHERE st_num = #{stNum}
   </update>
   
   <delete id="deleteStock" parameterType="stock">
      DELETE FROM Stock
      <where>
         <choose>
            <when test="stNumList != null and stNumList.length>0">
               st_num in
               <foreach collection="stNumList" open="(" close=")"
                  separator="," item="item">
                  #{item}
               </foreach>
            </when>
            <otherwise>
               st_num = #{stNum}
            </otherwise>
         </choose>
      </where>

   </delete>


</mapper>

 
 