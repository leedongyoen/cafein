<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 7.2.0.final using JasperReports Library version 6.6.0  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="refund" pageWidth="500" pageHeight="300" columnWidth="500" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="7f292e59-ac0a-4e81-aa2d-c83093ee5d91">
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w1" value="138"/>
	<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w2" value="854"/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="PRESSO"/>
	<parameter name="p_store" class="java.lang.String"/>
	<queryString language="SQL">
		<![CDATA[SELECT     nvl(to_char(SUM(case when o.pay_method = 'card' then o.total else 0 end),'999,999,999,999,999,999'),0) "cardRefundSum"
       		 , nvl(to_char(SUM(case when o.pay_method = 'cash' then o.total else 0 end),'999,999,999,999,999,999'),0) "cashRefundSum"
			 , nvl(to_char(COUNT(CASE WHEN o.PAY_METHOD = 'cash' THEN 1 ELSE NULL END),'999,999,999,999,999,999'),0) "cashRefundCnt"
			 , nvl(to_char(COUNT(CASE WHEN o.PAY_METHOD = 'card' THEN 1 ELSE NULL END),'999,999,999,999,999,999'),0) "cardRefundCnt"
			 , nvl(to_char(sum(o.total),'999,999,999,999,999,999'),0) "RefundSum"
       		 , nvl(to_char(COUNT(o.PAY_METHOD),'999,999,999,999,999,999'),0) "RefundCnt"
FROM ORDERS O JOIN STOREOPEN SOP
ON O.S_ID = SOP.S_ID 
AND TO_char(opentime,'yyyyMMdd') = TO_char(sysdate,'yyyyMMdd')
WHERE O.O_DATE BETWEEN (SELECT MAX(OPENTIME) FROM STOREOPEN) AND NVL(SOP.CLOSETIME,SYSTIMESTAMP)
AND O.TOTAL < 0
AND O.S_ID = $P{p_store}]]>
	</queryString>
	<field name="cardRefundSum" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="cardRefundSum"/>
	</field>
	<field name="cashRefundSum" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="cashRefundSum"/>
	</field>
	<field name="cashRefundCnt" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="cashRefundCnt"/>
	</field>
	<field name="cardRefundCnt" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="cardRefundCnt"/>
	</field>
	<field name="RefundSum" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="RefundSum"/>
	</field>
	<field name="RefundCnt" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="RefundCnt"/>
	</field>
	<background>
		<band splitType="Stretch"/>
	</background>
	<columnHeader>
		<band height="85" splitType="Stretch">
			<textField pattern="#,##0.###;(#,##0.###-)">
				<reportElement x="280" y="55" width="100" height="15" uuid="a6acdbe2-a908-4969-a08d-ee6c325f661f">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA[$F{cardRefundSum}+"원"]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.###;(#,##0.###-)">
				<reportElement x="280" y="40" width="100" height="15" uuid="4966c21b-a0cb-4aef-8729-a9edbb090eb8">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA[$F{cardRefundSum}+"원"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="160" y="40" width="100" height="15" uuid="c9454612-67e9-4de8-908d-e722a2602ce6">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA[$F{cashRefundCnt}+" 건"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="160" y="55" width="100" height="15" uuid="ccc19537-7197-4e3d-ba90-b0d3d12b6d6f">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA[$F{cardRefundCnt}+" 건"]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="229" y="7" width="43" height="15" uuid="cf4cdd45-399d-4dac-a438-e77816ec49ae"/>
				<text><![CDATA[환불내역]]></text>
			</staticText>
			<staticText>
				<reportElement x="120" y="40" width="50" height="15" uuid="893da6cf-6107-4cab-b44d-99a9d419d500"/>
				<text><![CDATA[현금]]></text>
			</staticText>
			<staticText>
				<reportElement x="120" y="55" width="50" height="15" uuid="f0634386-423c-4c71-9a46-05e600022cda"/>
				<text><![CDATA[카드]]></text>
			</staticText>
			<staticText>
				<reportElement x="120" y="70" width="50" height="15" uuid="17ac408f-a015-4e4c-8c6e-c873800caced"/>
				<text><![CDATA[합계]]></text>
			</staticText>
			<textField>
				<reportElement x="160" y="70" width="100" height="15" uuid="1dc7ef30-f3ce-42d1-90ea-fc5e18999c70">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA[$F{RefundCnt}+" 건"]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.###;(#,##0.###-)">
				<reportElement x="280" y="70" width="100" height="15" uuid="431d6101-678a-4fb1-ae54-985e82e6a370">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA[$F{RefundSum}+"원"]]></textFieldExpression>
			</textField>
			<line>
				<reportElement positionType="FixRelativeToBottom" x="100" y="29" width="300" height="1" uuid="5ea8c683-8f38-423b-a6d0-3a08e66248cd">
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<graphicElement>
					<pen lineWidth="0.5" lineColor="#999999"/>
				</graphicElement>
			</line>
			<line>
				<reportElement positionType="FixRelativeToBottom" x="100" y="0" width="300" height="1" uuid="45a06526-839a-449b-8bd5-beb8574a86bb"/>
				<graphicElement>
					<pen lineWidth="0.5" lineColor="#999999"/>
				</graphicElement>
			</line>
		</band>
	</columnHeader>
</jasperReport>
