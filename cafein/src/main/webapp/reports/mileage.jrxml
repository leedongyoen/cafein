<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 7.2.0.final using JasperReports Library version 6.6.0  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="mileage" pageWidth="500" pageHeight="300" columnWidth="500" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="dc84c891-25ea-4560-a287-9f5a7aef4685">
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w1" value="175"/>
	<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w2" value="816"/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="PRESSO"/>
	<parameter name="p_store" class="java.lang.String"/>
	<queryString language="SQL">
		<![CDATA[SELECT   nvl(to_char(SUM(case when o.total > 0 then o.mileage else 0 end),'999,999,999,999,999,999'),0) "mileage"
	        , nvl(to_char(COUNT(CASE WHEN MILEAGE > 0 THEN 1 ELSE NULL END),'999,999,999,999,999,999'),0) "minusMileageCnt"
		    , nvl(to_char(SUM(case when o.total > 0 then o.total else 0 end)*0.01,'999,999,999,999,999,999'),0) "addmileage"
		    , nvl(to_char(COUNT(CASE WHEN o.total > 0 THEN 1 ELSE NULL END),'999,999,999,999,999,999'),0) "addMileageCnt"
	        , nvl(to_char(sum(case when o.total < 0 then o.mileage else 0 end),'999,999,999,999,999,999'),0) "refundmileage"
	        , nvl(to_char(COUNT(CASE WHEN MILEAGE < 0 THEN 1 ELSE NULL END),'999,999,999,999,999,999'),0) "refundMileageCnt"
FROM ORDERS O ,( SELECT CLOSETIME, OPENTIME
					        FROM STOREOPEN
					        WHERE S_ID = $P{p_store}
					        AND TRUNC(OPENTIME) = '19/07/23') SOP
WHERE( O.O_DATE BETWEEN (SELECT MAX(OPENTIME) FROM STOREOPEN) AND NVL(SOP.CLOSETIME,SYSTIMESTAMP))
AND ( (O.RECEIPT='delivery' AND O.DELIVERY_STATUS IN ('C3', 'C5')) OR ( O.RECEIPT = 'takeout' AND O.DELIVERY_STATUS IN ('C3', 'C5')) )
AND O.S_ID = $P{p_store}]]>
	</queryString>
	<field name="mileage" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="mileage"/>
	</field>
	<field name="minusMileageCnt" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="minusMileageCnt"/>
	</field>
	<field name="addmileage" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="addmileage"/>
	</field>
	<field name="addMileageCnt" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="addMileageCnt"/>
	</field>
	<field name="refundmileage" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="refundmileage"/>
	</field>
	<field name="refundMileageCnt" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="refundMileageCnt"/>
	</field>
	<background>
		<band splitType="Stretch"/>
	</background>
	<columnHeader>
		<band height="85" splitType="Stretch">
			<staticText>
				<reportElement x="120" y="40" width="74" height="15" uuid="dd34a1c1-f745-48cc-9eaa-566b53f95436">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<text><![CDATA[포인트사용]]></text>
			</staticText>
			<staticText>
				<reportElement x="120" y="55" width="74" height="15" uuid="914233d8-291f-486d-8849-24f7f96af6f0">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<text><![CDATA[포인트적립]]></text>
			</staticText>
			<staticText>
				<reportElement x="120" y="70" width="74" height="15" uuid="be26fa1b-89b3-4eb7-98dc-02f240a6a108">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<text><![CDATA[환불포인트]]></text>
			</staticText>
			<textField pattern="#,##0.###;(#,##0.###-)">
				<reportElement x="280" y="40" width="100" height="15" uuid="2997c7a6-291f-4995-ace8-e097c56af386">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA[$F{mileage}+"P"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="160" y="40" width="100" height="15" uuid="db9f322c-d847-4623-955b-ff2f2c64af53">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA[$F{minusMileageCnt}+" 건"]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.###;(#,##0.###-)">
				<reportElement x="280" y="55" width="100" height="15" uuid="74235fb2-8969-43fe-a4c1-30e898e6f821">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA[$F{addmileage}+"P"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="160" y="55" width="100" height="15" uuid="c24e18e9-5df6-49cf-9e88-e1f6f93f0e98">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA[$F{addMileageCnt}+" 건"]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.###;(#,##0.###-)">
				<reportElement x="280" y="70" width="100" height="15" uuid="6981a063-56c0-49ca-a4c1-dd93f40aaa09">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA[$F{refundmileage}+"P"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="160" y="70" width="100" height="15" uuid="4c44b44c-48bb-4ef0-8bb6-46c00cc8f0b4">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA[$F{refundMileageCnt}+" 건"]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="221" y="8" width="59" height="15" uuid="5b18f4a5-748b-423e-a8aa-4f22e8af648c">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<textElement textAlignment="Center"/>
				<text><![CDATA[포인트 내역]]></text>
			</staticText>
			<line>
				<reportElement positionType="FixRelativeToBottom" x="100" y="29" width="300" height="1" uuid="713c2328-e754-4288-aa5f-bf877a4c8cef"/>
				<graphicElement>
					<pen lineWidth="0.5" lineColor="#999999"/>
				</graphicElement>
			</line>
			<line>
				<reportElement positionType="FixRelativeToBottom" x="100" y="1" width="300" height="1" uuid="1098bb07-294e-41b6-a8ba-33fbf16642e0"/>
				<graphicElement>
					<pen lineWidth="0.5" lineColor="#999999"/>
				</graphicElement>
			</line>
		</band>
	</columnHeader>
</jasperReport>
